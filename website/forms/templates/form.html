<!DOCTYPE html>
{% extends "base.html" %}
{% load static %}
{% load permissions %}
{% block content %}
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Request Form</title>
  <link rel="stylesheet" href="{% static 'forms/css/form.css' %}">
</head>
<body>
  <h1>Machine Engineering Request Form</h1>

  <!-- Success Message -->
  {% if messages %}
  <div class="success-messages">
    {% for message in messages %}
      <p>{{ message }}</p>
    {% endfor %}
  </div>
  {% endif %}

  <!-- Requestor's Section -->
  <form action="/submit-request/" method="POST" enctype="multipart/form-data" class="form-section">
    {% csrf_token %}
    
    <fieldset>
      <legend>Request Details</legend>
      <label for="request_type">Type of Request:</label><br>
      <select id="request_type" name="request_type" {% if not user|has_perm:"forms.can_submit_request" %}disabled{% endif %} required>
        <option value="project">Project</option>
        <option value="modification">Modification</option>
        <option value="drawing">Drawing</option>
      </select>
      <br><br>

      <label for="proposed_title">Proposed Title:</label>
      <input type="text" id="proposed_title" name="proposed_title" {% if not user|has_perm:"forms.can_submit_request" %}disabled{% endif %} required>
      <br><br>

      <label for="request_date">Request Date:</label>
      <input type="date" id="request_date" name="request_date" {% if not user|has_perm:"forms.can_submit_request" %}disabled{% endif %} required readonly>
      <br><br>

      <script>
        document.addEventListener("DOMContentLoaded", function() {
          let today = new Date().toISOString().split('T')[0]; // Get today's date in YYYY-MM-DD format
          document.getElementById('request_date').value = today;
        });
      </script>

      <label for="user_requirement_specification">User Requirement Specification:</label>
      <br>
      <textarea id="user_requirement_specification" name="user_requirement_specification" rows="4" {% if not user|has_perm:"forms.can_submit_request" %}disabled{% endif %}></textarea>
      <br><br>

      <label for="uploaded_file">Upload File:</label>
      <input type="file" id="uploaded_file" name="uploaded_file" {% if not user|has_perm:"forms.can_submit_request" %}disabled{% endif %} accept=".pdf,.doc,.docx,.jpg,.png,.xlsx">
      <br><br>

      <label for="purpose">Purpose:</label>
      <input type="text" id="purpose" name="purpose" {% if not user|has_perm:"forms.can_submit_request" %}disabled{% endif %} required>
      <br><br>

      <label for="scope">Scope:</label>
      <input type="text" id="scope" name="scope" {% if not user|has_perm:"forms.can_submit_request" %}disabled{% endif %} required>
      <br><br>

      <label for="requested_by">Requested by:</label>
      <input type="text" id="requested_by" name="requested_by" {% if not user|has_perm:"forms.can_submit_request" %}disabled{% endif %} required>
      <br><br>

      <button type="submit" {% if not user|has_perm:"forms.can_submit_request" %}disabled{% endif %}>Submit Request</button>
    </fieldset>
  </form>

  <!-- Manager's Approval Section -->
  <form action="/manager-approval/" method="POST" class="form-section">
    {% csrf_token %}
    <fieldset>
      <legend>Manager's Approval</legend>
      <label for="manager_name">Manager's Name:</label>
      <input type="text" id="manager_name" name="manager_name" {% if not user|has_perm:"forms.can_approve_request" %}disabled{% endif %} required>
      <br><br>

      <label for="approval_status">Approval Status:</label><br>
      <input type="radio" id="approve" name="approval_status" value="approve" {% if not user|has_perm:"forms.can_approve_request" %}disabled{% endif %} required>
      <label for="approve">Approved</label><br>
      <input type="radio" id="reject" name="approval_status" value="reject" {% if not user|has_perm:"forms.can_approve_request" %}disabled{% endif %} required>
      <label for="reject">Not Approved</label><br>
      <br><br>

      <label for="manager_remarks">Remarks:</label>
      <br>
      <textarea id="manager_remarks" name="manager_remarks" rows="4" {% if not user|has_perm:"forms.can_approve_request" %}disabled{% endif %}></textarea>
      <br><br>

      <button type="submit" {% if not user|has_perm:"forms.can_approve_request" %}disabled{% endif %}>Submit Approval</button>
    </fieldset>
  </form>

  <!-- Receiver's Section -->
  <form action="/receiver-action/" method="POST" class="form-section">
    {% csrf_token %}
    <fieldset>
      <legend>To be filled by PE - PMD personnel</legend>
      <label for="verified_by">Verified by:</label>
      <input type="text" id="verified_by" name="verified_by" {% if not user|has_perm:"forms.can_fill_receiver_section" %}disabled{% endif %}>
      <br><br>

      <label for="design_in_charge">Design In Charge:</label>
      <select id="design_in_charge" name="design_in_charge" {% if not user|has_perm:"forms.can_fill_receiver_section" %}disabled{% endif %}>
          <option value="">-- Select Designer --</option>
          <option value="designer1">Peter Romanillos</option>
          <option value="designer2">Roseller Carido</option>
          <option value="designer3">Christian Lloyd Porol</option>
          <option value="designer4">Julito Pangalay Jr.</option>
          <option value="designer5">Mark Joseph Planca</option>
          <option value="designer6">Meldin Evangelista</option>
          <option value="designer7">Jay Mari Quilantang</option>
          <option value="designer8">Sherry Balandra</option>
          <option value="designer9">Jade Macalalad</option>
      </select>
      <br><br>

      <label for="control_number">Control Number:</label>
      <input type="text" id="control_number" name="control_number" {% if not user|has_perm:"forms.can_fill_receiver_section" %}disabled{% endif %}>
      <br><br>

      <input type="radio" id="approve" name="approval_status" value="approve" {% if not user|has_perm:"forms.can_fill_receiver_section" %}disabled{% endif %}>
      <label for="approve">Approved</label><br>
      <input type="radio" id="reject" name="approval_status" value="reject" {% if not user|has_perm:"forms.can_fill_receiver_section" %}disabled{% endif %}>
      <label for="reject">Not Approved</label><br>
      <br><br>

      <label for="remarks">Remarks:</label>
      <input type="text" id="remarks" name="remarks" {% if not user|has_perm:"forms.can_fill_receiver_section" %}disabled{% endif %}>
      <br><br>

      <label for="start_target_dates">Start Date and Target Date:</label>
      <input type="text" id="start_target_dates" name="start_target_dates" {% if not user|has_perm:"forms.can_fill_receiver_section" %}disabled{% endif %}>
      <br><br>
    </fieldset>
  </form>

  <!-- Validation Section -->
  <form action="/validation-action/" method="POST" class="form-section">
    {% csrf_token %}
    <fieldset>
      <legend>To be filled by concerned division</legend>
      <input type="radio" id="general" name="validation_status" value="general" {% if not user|has_perm:"forms.can_validate_request" %}disabled{% endif %}>
      <label for="general">Approved</label><br>
      <input type="radio" id="technical" name="validation_status" value="technical" {% if not user|has_perm:"forms.can_validate_request" %}disabled{% endif %}>
      <label for="technical">Not Approved</label><br>
      <br><br>

      <label for="division_remarks">Remarks:</label>
      <br>
      <textarea id="division_remarks" name="division_remarks" rows="4" {% if not user|has_perm:"forms.can_validate_request" %}disabled{% endif %}></textarea>
      <br><br>

      <label for="received_by">Received By:</label>
      <input type="text" id="received_by" name="received_by" {% if not user|has_perm:"forms.can_validate_request" %}disabled{% endif %}>
      <br><br>

      <label for="date_received">Date Received:</label>
      <input type="date" id="date_received" name="date_received" {% if not user|has_perm:"forms.can_validate_request" %}disabled{% endif %}>
      <br><br>

      <input type="radio" id="ok" name="final_status" value="ok" {% if not user|has_perm:"forms.can_validate_request" %}disabled{% endif %}>
      <label for="ok">OK</label><br>
      <input type="radio" id="no_good" name="final_status" value="no_good" {% if not user|has_perm:"forms.can_validate_request" %}disabled{% endif %}>
      <label for="no_good">NO GOOD</label><br>
      <br><br>

      <label for="result_remarks">Remarks:</label>
      <br>
      <textarea id="result_remarks" name="result_remarks" rows="4" {% if not user|has_perm:"forms.can_validate_request" %}disabled{% endif %}></textarea>
      <br><br>

      <label for="remarks_by">Remarks By:</label>
      <input type="text" id="remarks_by" name="remarks_by" {% if not user|has_perm:"forms.can_validate_request" %}disabled{% endif %}>
      <br><br>

      <label for="verified_by">Verified By:</label>
      <input type="text" id="verified_by" name="verified_by" {% if not user|has_perm:"forms.can_validate_request" %}disabled{% endif %}>
      <br><br>
    </fieldset>
  </form>
</body>
</html>
{% endblock %}